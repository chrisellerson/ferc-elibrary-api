"use strict";var f=Object.defineProperty;var d=(a,t,e)=>t in a?f(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var i=(a,t,e)=>(d(a,typeof t!="symbol"?t+"":t,e),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("fs"),g=require("path");class h{constructor(){i(this,"params",{});i(this,"data")}}function c(a,t="post"){return async e=>fetch(`https://elibrary.ferc.gov/eLibrarywebapi/api/${a}`,{headers:{"content-type":"application/json"},method:t,...t!=="get"?{body:JSON.stringify(e)}:{}}).then(s=>s.json())}const u={dockets:"rp24-769",subdockets:"000",filed_date_beg:"01-01-1960",filed_date_end:"06-04-2024",complete_flag:0,numHits:100,pageNumber:0};class P extends h{constructor(e){super();i(this,"defaultParams",u);i(this,"fetch",c("Docket/GetSingleDocketSheet"));this.params={...this.defaultParams,...e}}async getData(){this.data=await this.fetch(this.params)}updateParams(e){this.params={...u,...e}}async nextPage(){var r;const{numHits:e,pageNumber:s}=this.params;return(((r=this.data)==null?void 0:r.Page.totalHits)??-1)>e*(s+1)?(this.params.pageNumber++,await this.getData(),!0):!1}async prevPage(){const{pageNumber:e}=this.params;return e>0?(this.params.pageNumber--,await this.getData(),!0):!1}}const o={by:"rbFilingDate",start:"06-04-2024",end:"06-04-2024"};class y extends h{constructor(e){super();i(this,"defaultParams",o);i(this,"fetch",c(""));this.params={...this.defaultParams,...e},this.setFetch()}setFetch(){this.fetch=c(`Docket/GetATMSdocs/${this.params.by}/${this.params.start}/${this.params.end}/DocketFullNumber`,"get")}async getData(){this.data=await this.fetch({})}updateParams(e){this.params={...o,...e},this.setFetch()}}const l={searchText:"*",searchFullText:!0,searchDescription:!0,dateSearches:[],availability:null,affiliations:[],categories:[],libraries:[],accessionNumber:null,eFiling:!1,docketSearches:[{docketNumber:"P-15056-000",subDocketNumbers:[]}],resultsPerPage:100,curPage:1,classTypes:[],sortBy:"",groupBy:"NONE",idolResultID:"",allDates:!1};class D extends h{constructor(e){super();i(this,"defaultParams",l);i(this,"fetch",c("Search/AdvancedSearch"));this.params={...this.defaultParams,...e},this.params.curPage===0&&(this.params.curPage=1)}async getData(){this.data=await this.fetch(this.params)}updateParams(e){this.params={...l,...e}}async nextPage(){var r;const{resultsPerPage:e,curPage:s}=this.params;return(((r=this.data)==null?void 0:r.totalHits)??-1)>e*s?(this.params.curPage++,await this.getData(),!0):!1}async prevPage(){const{curPage:e}=this.params;return e>1?(this.params.curPage--,await this.getData(),!0):!1}}const n={path:"temp",format:"pdf",file:"temp"};async function b(a,t){const e={...n,file:a.fileidLst[0]??n.file,...t};return p(e,"File/DownloadP8File",{},a)}async function S(a,t){const e={...n,file:a,...t};return p(e,"File/DownloadPDF",{accessionNumber:a},'{serverLocation: ""}')}async function p(a,t,e,s){return fetch(`https://elibrary.ferc.gov/eLibrarywebapi/api/${t}?`+new URLSearchParams(e),{headers:{accept:"application/json, text/plain, */*","content-type":"application/json"},body:typeof s=="string"?s:JSON.stringify(s),method:"POST"}).then(r=>r.arrayBuffer()).then(r=>m.writeFileSync(g.join(a.path,`${a.file}.${a.format}`),Buffer.from(r),"binary"))}exports.DocketSearch=P;exports.GeneralSearch=D;exports.NewDocketSearch=y;exports.downloadFile=b;exports.generatePDF=S;
